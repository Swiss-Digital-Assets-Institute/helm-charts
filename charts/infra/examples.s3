aws:
  enabled: true
  region: us-west-1
  providerConfigRef:
    name: aws-provider-config
  s3:
    enabled: true
    bucketNameOverride: ""
    objectOwnership: "BucketOwnerEnforced"
    
    lifeCycleConfiguration:
      enabled: true
      rule:
        # Rule 1: Transition objects to different storage classes
        - id: transition-to-glacier
          status: Enabled
          filter:
            prefix: logs/
          transition:
            - days: 30
              storageClass: STANDARD_IA
            - days: 90
              storageClass: GLACIER
            - days: 180
              storageClass: DEEP_ARCHIVE
        
        # Rule 2: Expire old objects
        - id: expire-old-files
          status: Enabled
          filter:
            prefix: temp/
          expiration:
            days: 7
        
        # Rule 3: Delete incomplete multipart uploads
        - id: cleanup-incomplete-uploads
          status: Enabled
          abortIncompleteMultipartUpload:
            daysAfterInitiation: 7
        
        # Rule 4: Expire objects with specific tags
        - id: expire-tagged-objects
          status: Enabled
          filter:
            tag:
              - key: Environment
                value: Development
          expiration:
            days: 30
        
        # Rule 5: Transition and expire with multiple filters
        - id: archive-old-backups
          status: Enabled
          filter:
            and:
              prefix: backups/
              tag:
                - key: Type
                  value: Backup
          transition:
            - days: 60
              storageClass: GLACIER
          expiration:
            days: 365
        
        # Rule 6: Expire non-current versions (for versioned buckets)
        - id: expire-old-versions
          status: Enabled
          noncurrentVersionExpiration:
            noncurrentDays: 90
          noncurrentVersionTransition:
            - noncurrentDays: 30
              storageClass: STANDARD_IA
        
        # Rule 7: Expire objects by date
        - id: expire-by-date
          status: Enabled
          filter:
            prefix: reports/2024/
          expiration:
            date: "2025-12-31T00:00:00Z"
    
    versioning:
      enabled: false
    
    corsConfiguration:
      enabled: true
      corsRules:
        - allowedHeaders:
            - '*'
          allowedMethods:
            - PUT
            - POST
          allowedOrigins:
            - https://s3-website-test.hashicorp.com
          exposeHeaders:
            - ETag
          maxAgeSeconds: 3000
        - allowedMethods:
            - GET
          allowedOrigins:
            - '*'
    
    bucketWebsiteConfiguration:
      enabled: true
      errorDocument:
        key: error.html
      indexDocument:
        suffix: index.html
      routingRules:
        - condition:
            keyPrefixEquals: docs/
          redirect:
            replaceKeyPrefixWith: documents/
    
    bucketPublicAccessBlock:
      enabled: true
      blockPublicAcls: false
      blockPublicPolicy: false
      ignorePublicAcls: false
      restrictPublicBuckets: false